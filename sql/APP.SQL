CREATE TABLE IF NOT EXISTS "USER"
(
    ID SERIAL PRIMARY KEY,
    EMAIL VARCHAR(30) NOT NULL,
    FIRST_NAME VARCHAR(30) NOT NULL,
    LAST_NAME VARCHAR(30) NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT UQ_USER_EMAIL UNIQUE (EMAIL)
);

INSERT INTO "USER" (EMAIL, FIRST_NAME, LAST_NAME)
SELECT 'SYSTEM', 'SYSTEM', 'SYSTEM';

CREATE TABLE IF NOT EXISTS ARTIFACT
(
    ID SERIAL PRIMARY KEY,
    QUIZ_ID INT NULL,

    META_TYPE VARCHAR(20) NOT NULL,
    FILE_TYPE VARCHAR(20) NOT NULL,
    PATH VARCHAR(100) NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_ARTIFACT_R_QUIZ FOREIGN KEY (QUIZ_ID) REFERENCES QUIZ(ID)
);

CREATE TABLE IF NOT EXISTS QUIZ
(
    ID SERIAL PRIMARY KEY,
    TEMPLATE_ID INT NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_ARTIFACT_VARIABLE_R_ARTIFACT FOREIGN KEY (TEMPLATE_ID) REFERENCES ARTIFACT(ID)
);

CREATE TABLE IF NOT EXISTS ARTIFACT_VARIABLE
(
    ID SERIAL PRIMARY KEY,
    TEMPLATE_ID INT NOT NULL,
    QUIZ_ID INT NULL,

    INPUT VARCHAR(2048) NOT NULL,
    NAME VARCHAR(20) NOT NULL,
    VALUE VARCHAR(5000) NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_ARTIFACT_VARIABLE_R_ARTIFACT FOREIGN KEY (TEMPLATE_ID) REFERENCES ARTIFACT(ID),
    CONSTRAINT FK_ARTIFACT_VARIABLE_R_QUIZ FOREIGN KEY (QUIZ_ID) REFERENCES QUIZ(ID)
);

CREATE TABLE IF NOT EXISTS SITE
(
    ID SERIAL PRIMARY KEY,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL
);

CREATE TABLE IF NOT EXISTS SITE_ARTIFACT_LINK
(
    ID SERIAL PRIMARY KEY,

    SITE_ID INT NOT NULL,
    ARTIFACT_ID INT NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_SITE_ARTIFACT_LINK_R_SITE FOREIGN KEY (SITE_ID) REFERENCES SITE(ID),
    CONSTRAINT FK_SITE_ARTIFACT_LINK_R_ARTIFACT FOREIGN KEY (ARTIFACT_ID) REFERENCES ARTIFACT(ID)
);

CREATE TABLE IF NOT EXISTS QUIZ_QUESTION
(
    ID INT PRIMARY KEY,
    QUESTION_ID INT NULL,

    QUESTION VARCHAR(1024) NULL,
    DESCRIPTION VARCHAR(1024) NULL,
    VARIABLE VARCHAR(50) NULL,
    TYPE VARCHAR(50) NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_QUIZ_QUESTION_R_QUIZ_QUESTION FOREIGN KEY (QUESTION_ID) REFERENCES QUIZ_QUESTION(ID)
);

INSERT INTO QUIZ_QUESTION(ID, QUESTION_ID, VARIABLE, TYPE, QUESTION, DESCRIPTION)
VALUES
    (1, NULL, NULL, 'page', 'Letâ€™s Start Creating Your Website', NULL),
    (2, NULL, NULL, 'page', 'Which colors you like best?', 'Choose the color combination for your website.'),
    (3, NULL, NULL, 'page', 'Can you provide high-quality photos of your dental clinic, including the interior, exterior, and team members? (Up to 2)', NULL),
    (4, NULL, NULL, 'page', 'What dental services does your clinic offer?', 'E.g., general dentistry, cosmetic dentistry, orthodontics, pediatric dentistry.'),
    (5, NULL, NULL, 'page', 'Check a description of each service you offer', 'The AI generates services description based on their names. You can always edit the text later.'),
    (6, NULL, NULL, 'page', 'Can you provide names and titles for each team member?', NULL),
    (7, NULL, NULL, 'page', 'What are your clinic''s regular operating hours?', NULL),
    (8, NULL, NULL, 'page', 'What is the full address of your dental clinic?', NULL),
    (9, NULL, NULL, 'page', 'What are your clinic''s phone number, email address, and any other relevant contact details?', NULL),
    (10, NULL, NULL, 'page', 'Do you have social media profiles that you would like to link to your website? If so, please provide the URLs.', NULL);

CREATE TABLE IF NOT EXISTS QUIZ_ANSWER
(
    ID SERIAL PRIMARY KEY,

    QUIZ_ID INT NOT NULL,
    QUESTION_ID INT NOT NULL,
    VALUE VARCHAR(5000) NOT NULL,

    CREATED_DATE TIMESTAMP NOT NULL DEFAULT NOW(),
    MOD_DATE TIMESTAMP NULL,
    CREATED_BY INT NOT NULL,
    MOD_BY INT NULL,

    CONSTRAINT FK_QUIZ_ANSWER_R_QUIZ FOREIGN KEY (QUIZ_ID) REFERENCES QUIZ(ID),
    CONSTRAINT FK_QUIZ_ANSWER_R_QUIZ_QUESTION FOREIGN KEY (QUESTION_ID) REFERENCES QUIZ_QUESTION(ID)
);
